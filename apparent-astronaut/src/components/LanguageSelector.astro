---
// src/components/LanguageSelector.astro
export interface Props {
  currentLocale: string;
}

const { currentLocale } = Astro.props;

const languages = [
  { code: 'en', label: 'English', flag: 'us' },
  { code: 'es', label: 'EspaÃ±ol', flag: 'ðŸ‡ªðŸ‡¸' },
  { code: 'fr', label: 'FranÃ§ais', flag: 'ðŸ‡«ðŸ‡·' },
];

const { pathname } = Astro.url;
const basePath = pathname.replace(/^\/(en|es|fr)/, '') || '/';
---

<nav class="fixed top-4 right-4 z-50">
  <div class="relative" x-data="{ open: false }">
    <!-- BotÃ³n del idioma actual -->
    <button 
      @click="open = !open"
      @keydown.escape="open = false"
      class="flex items-center gap-2 px-4 py-2 bg-white rounded-lg shadow-md hover:shadow-lg transition border border-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500"
    >
      <span class="text-lg">
        {languages.find(lang => lang.code === currentLocale)?.flag}
      </span>
      <span class="font-medium text-gray-700 hidden sm:inline">
        {languages.find(lang => lang.code === currentLocale)?.label}
      </span>
      <svg 
        class="w-4 h-4 text-gray-500 transition-transform duration-200" 
        :class="{ 'rotate-180': open }" 
        fill="none" 
        stroke="currentColor" 
        viewBox="0 0 24 24"
      >
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </button>

    <!-- Dropdown -->
    <div 
      x-show="open" 
      @click.away="open = false"
      x-transition:enter="transition ease-out duration-200"
      x-transition:enter-start="opacity-0 scale-95"
      x-transition:enter-end="opacity-100 scale-100"
      x-transition:leave="transition ease-in duration-150"
      x-transition:leave-start="opacity-100 scale-100"
      x-transition:leave-end="opacity-0 scale-95"
      class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-200 z-50"
      style="display: none;"
    >
      {languages.map((lang) => (
        <a
          key={lang.code}
          href={`/${lang.code}${basePath}`}
          class={`
            flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition
            ${lang.code === currentLocale ? 'bg-blue-50 text-blue-600' : 'text-gray-700'}
            ${lang.code === languages[0].code ? 'rounded-t-lg' : ''}
            ${lang.code === languages[languages.length - 1].code ? 'rounded-b-lg' : ''}
          `}
        >
          <span class="text-lg">{lang.flag}</span>
          <span class="font-medium">{lang.label}</span>
          {lang.code === currentLocale && (
            <svg class="w-4 h-4 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
          )}
        </a>
      ))}
    </div>
  </div>
</nav>